<!DOCTYPE html>
<html lang="en">
<head>
	<title>Kenneth's log - GitHub</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
	<link href=".././feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Kenneth's log ATOM Feed" />
	



	<!--[if IE]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

	<!--[if lte IE 7]>
		<link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
		<script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

	<!--[if lt IE 7]>
		<link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

<a href="http://github.com/kennethreitz/">

<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />

</a>

	<header id="banner" class="body">
		<h1>
			<a href="../.">Kenneth's log </a>
		</h1>
		
		<nav><ul>
		
		
		
		
			
				
			
				
			
		
		
		
		    <li >
				<a href=".././category/Code.html">Code</a>
			</li>
		
		    <li >
				<a href=".././category/projects.html">projects</a>
			</li>
		
		
		</ul></nav>
		
	</header><!-- /#banner -->

			   

		 
	
		<aside id="featured" class="body"><article>
				<h1 class="entry-title"><a href=".././github-syncer-in-python.html">GitHub Syncer in Python</a></h1> 
				<footer class="post-info">
						<abbr class="published" title="2010-10-10T16:20:00">
								Sun 10 October 2010
						</abbr>

				<p>In <a href=".././category/Code.html">Code</a>. </p>
				<p>tags: <a href=".././tag/GitHub.html">GitHub</a><a href=".././tag/Python.html">Python</a></p>
</p>
				</footer><!-- /.post-info -->
				<p>Today I rewrote a little utility I’ve been using for a while to keep all of my GitHub repos up to date and organized. It updates / clones all private, public, and watched repositories from your account. It also detects if your repo is a mirror or fork, and files it accordingi.</p>
<p>My watched list is huge, but I like to have a local copy of my favorite libraries. You never know if the owner will take it down, or worse, move it to another SCM! ;-)</p>
<p>The script depends on the GitHub2 module. If you don’t have it, you can install it easily.</p>
<pre class="literal-block">
$ pip install github2
</pre>
<p>I recommend running this from <tt class="docutils literal">~/repos/</tt>.</p>
<pre class="literal-block">
#!/usr/bin/env python
# -*- coding: utf-8 -*-

&quot;&quot;&quot;Kenneth Reitz's GitHub Syncer

This script uses the GitHub API to get a list of all forked, mirrored, public, and
private repos in your GitHub account. If the repo already exists locally, it will
update it via git-pull. Otherwise, it will properly clone the repo.

It will organize your repos into the following directory structure:

+ repos
  ├── forks    (public fork repos)
  ├── mirrors  (public mirror repos)
  ├── private  (private repos)
  ├── public   (public repos)
  ├── watched  (public watched repos)
  └── sync.py  (this script)

Requires Ask Solem's github2 (http://pypi.python.org/pypi/github2).

Inspired by Gisty (http://github.com/swdyh/gisty).
&quot;&quot;&quot;

import os
from commands import getoutput as cmd

from github2.client import Github


# GitHub configurations
GITHUB_USER = cmd('git config github.user')
GITHUB_TOKEN = cmd('git config github.token')

# API Object
github = Github(username=GITHUB_USER, api_token=GITHUB_TOKEN)


# repo slots
repos = {}

repos['watched'] = [r for r in github.repos.watching(GITHUB_USER)]
repos['private'] = []
repos['mirrors'] = []
repos['public'] = []
repos['forks'] = []

# Collect GitHub repos via API
for repo in github.repos.list():

    if repo.private:
        repos['private'].append(repo)
    elif repo.fork:
        repos['forks'].append(repo)
    elif 'mirror' in repo.description.lower():
        # mirrors owned by self if mirror in description...
        repos['mirrors'].append(repo)
    else:
        repos['public'].append(repo)


for org, repos in repos.iteritems():
    for repo in repos:

        # create org directory (safely)
        try:
            os.makedirs(org)
        except OSError:
            pass

        # enter org dir
        os.chdir(org)

        # I own the repo
        private = True if org in ('private', 'fork', 'mirror') else False

        # just `git pull` if it's already there
        if os.path.exists(repo.name):
            os.chdir(repo.name)
            print('Updating repo: %s' % (repo.name))
            os.system('git pull')
            os.chdir('..')
        else:
            if private:
                print('Cloning private repo: %s' % (repo.name))
                os.system('git clone git&#64;github.com:%s/%s.git' % (repo.owner, repo.name))
            else:
                print('Cloning repo: %s' % (repo.name))
                os.system('git clone git://github.com/%s/%s.git' % (repo.owner, repo.name))

        # return to base
        os.chdir('..')
        print
</pre>

				
				</article>
				</aside><!-- /#featured -->
		
	

</ol><!-- /#posts-list -->
</section><!-- /#content -->



	<section id="extras" class="body">

	
		<div class="blogroll">
			<h2>Links</h2>
			<ul>
			
			    <li><a href="http://github.com/kennethreitz">GitHub Repos</a></li>
			
			    <li><a href="http://flickr.com/kennethreitz">Photography (Flickr)</a></li>
			
			    <li><a href="http://twitter.com/kennethreitz">Latest Tweets</a></li>
			
			    <li><a href="http://www.linkedin.com/in/kennethreitz">R&eacute;sum&eacute;</a></li>
			
			    <li><a href="http://pick.im/kenneth-reitz">Design Portfolio</a></li>
			
			    <li><a href="http://laterstars.com/kennethreitz">Later Stars</a></li>
			
			</ul>
		</div><!-- /.blogroll -->
	

	
		<div class="social">
			<h2>social</h2>
			<ul>
			    <li><a href=".././feeds/all.atom.xml" rel="alternate">atom feed</a></li>
			    

			
			    <li><a href="http://facebook.com/kennethreitz">Facebook</a></li>
			
			</ul>
		</div><!-- /.social -->
	

	</section><!-- /#extras -->

	<footer id="contentinfo" class="body">
		<address id="about" class="vcard body">
		&copy; 2011 Kenneth Reitz &amp; co. .
		</address><!-- /#about -->

	</footer><!-- /#contentinfo -->



<script type="text/javascript">
    var disqus_shortname = 'kennethreitz';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script type="text/javascript" charset="utf-8">
	var disqus_developer = 1;
</script>

</body>
</html>